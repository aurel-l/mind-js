<!doctype html>

<script src="../bower_components/fetch/fetch.js"></script>
<script src="../bower_components/z-schema/dist/ZSchema-browser-min.js"></script>

<script>
  var validator = new ZSchema();
  var urls = ['schema', 'test-fichier-json.json'];
  Promise.all(
    urls.map(function(url) {
      return fetch(url);
    })
  ).then(function(responses) {
    return Promise.all(
      responses.map(function(response) {
        return response.json();
      })
    );
  }).then(function(parsed) {
    console.log(parsed);
    valid = validator.validate(parsed[0], parsed[1]);
    if (!valid) {
      throw validator.getLastErrors();
    } else {
      return valid;
    }
  }).then(function() {
    console.log('valid json file');
  }, function(err) {
    console.error('invalid json file');
    console.error(err);
  }).catch(function(err) {
    console.error(err);
  });
</script>
